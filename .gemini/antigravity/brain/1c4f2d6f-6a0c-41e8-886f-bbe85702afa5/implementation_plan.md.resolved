# Implementation Plan: Macro Math Engine (Project Titan) ðŸ›ï¸

**Objective**: Convert the "Macro" video concepts into a rigid, mathematically perfect trading engine that mimics [Monster_Scanner.pine](file:///c:/Users/Abdullah/Projects/g%C3%B6sterge/Monster_Scanner.pine) but for high-timeframe macro cycles.

## 1. Mathematical Axioms (The "Truth")

### A. The Trend Framework (The River)
*Video Logic: "Price is noise, MAs are truth."*
1.  **Bull Market**: Price > Daily 200 SMA AND Price > Weekly 50 SMA.
2.  **Bear Market**: Price < Daily 200 SMA AND Price < Weekly 50 SMA.
3.  **Value Zone (Buy Dip)**: Price between Weekly 50 SMA and Weekly 100 SMA.
4.  **Generational Bottom**: Price at Weekly 200 SMA (The "Death Line").

### B. The Cycle Fibonacci (The Grid)
*Video Logic: "Every cycle respects the Golden Pocket."*
1.  **Pivot Detection**: `ta.highest(200)` and `ta.lowest(200)` on Weekly timeframe.
2.  **Retracement Levels**:
    -   **EQ (0.5)**: The "Fair Value".
    -   **Golden Pocket (0.618 - 0.66)**: The "Reload Zone".
3.  **Extension Levels** (for Targets):
    -   **1.618**: The "Eupyoria" Target.
    -   **2.618**: The "Blow-off Top".

### C. The Weekly Operating System (Monday Range)
*Video Logic: "Monday is manipulation. Tuesday reveals truth."*
1.  **Monday Range**: High/Low of Monday (00:00 - 23:59 UTC).
2.  **Eq**: (Monday High + Monday Low) / 2.
3.  **Extensions**:
    -   **Range Size**: `R = High - Low`
    -   **Targets**: `High + R` (1.0 Ext), `High + 2R` (2.0 Ext).
    -   **Stop Hunting**: "Fakeout" detection (Price breaks Monday High, then closes below it = Short Signal).

### Manual Verification
- Asking the user to deploy to staging and testing, verifying UI changes on an iOS app etc.

# Phase 2: Titan V2 Specifications

## 1. Daily Equilibrium (EQ)
- **Concept**: The "Magnet" price for the current day.
- **Formula**: `(Previous Day High + Previous Day Low) / 2`.
- **Logic**: If price is above EQ -> Bullish skew for intraday. Below -> Bearish.

## 2. Smart Visuals ("Adam Gibi" Overhaul)
- **Reference**: [Monster_Strategy.pine](file:///c:/Users/Abdullah/Projects/g%C3%B6sterge/Monster_Strategy.pine) style.
- **Labels**:
    -   **Entry Label**: `ENTRY` + `QTY` + `RISK $`.
    -   **Exit Labels**: `âœ… WIN` / `âŒ LOSS` with PnL amount.
    -   **Style**: `label.style_label_left`, dark background, white text.
- **Lines**: Entry (Gray), SL (Red), TP (Green).
- **Icons**: Use `âœ…` and `âŒ` for clarity.

## 3. Multi-Asset "Signal" Panel
- **concept**: Embed the `Monster_Scanner` loop *inside* `Macro_Math_Engine`.
- **Execution**: The Strategy calculates *backtest* for the current chart (e.g. BTC), but the *Table* shows live "Trend River" status for 10 other assets (ETH, SOL, etc.) using `request.security` tuples.
- **Win/Loss Tracking**: Add `strategy.wintrades` and `strategy.losstrades` to the panel.

## 4. Auto-Fibs (Dynamic)
- **Constraint**: User wants it "Automatic".
- **Refinement**: Instead of fixed lookback (300 bars), use `ta.pivothigh(high, 50, 50)` to find the *last major cycle peak* dynamically.

## 2. Architecture: The "Monster" Structure
We will use the **Array-Based Scanner** pattern from [Monster_Scanner.pine](file:///c:/Users/Abdullah/Projects/g%C3%B6sterge/Monster_Scanner.pine).

### The "Screener" Logic (Loop)
```pine
// Pseudo-Code Concept
for symbol in [BTC, ETH, SOL, SPX, NASDAQ, GOLD...]
    // 1. Fetch Data (Tuple Packing to save requests)
    [d200, w50, w200, mon_h, mon_l] = request_data(symbol)

    // 2. Compute State
    score = 0
    if price > d200 and price > w50 -> score += 10 (Trend)
    if price < mon_eq -> score -= 5 (Weakness)
    if price inside Golden_Pocket -> score += 50 (Setup!)

    // 3. Render Dashboard
    table.cell(symbol, score, bias)
```

## 3. Deliverables
1.  [Macro_Math_Engine.pine](file:///c:/Users/Abdullah/Projects/g%C3%B6sterge/Macro_Math_Engine.pine): The single-chart strategy tool (Backtester).
2.  [Macro_Scanner.pine](file:///c:/Users/Abdullah/Projects/g%C3%B6sterge/Macro_Scanner.pine): The multi-ticker dashboard (Heatmap).

## CEO Approval
> "This isn't just an indicator. It's a Hedge Fund on a Laptop. Approved." - CEO
